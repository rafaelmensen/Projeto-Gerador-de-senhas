# importing openpyxl module 
import openpyxl as xl; 

# opening the source excel file 
filename ="testes\positivacao\planilha01.xlsx"
wb1 = xl.load_workbook(filename) 
ws1 = wb1.worksheets[0] 

# opening the destination excel file 
filename1 ="testes\positivacao\planilha02.xlsx"
wb2 = xl.load_workbook(filename1) 
ws2 = wb2.active 

# calculate total number of rows and 
# columns in source excel file 
mr = ws1.max_row 
mc = ws1.max_column 

# copying the cell values from source 
# excel file to destination excel file 
for i in range (1, mr + 100): 
	for j in range (1, mc + 100): 
		# reading cell value from source excel file 
		c = ws1.cell(row = 1, column = j) 

		# writing the read value to destination excel file 
		ws2.cell(row = i, column = j).value = c.value 

# saving the destination excel file 
wb2.save(str(filename1)) 

import openpyxl as xl

# Abrindo o arquivo Excel de origem
filename = "testes/positivacao/planilha01.xlsx"
wb1 = xl.load_workbook(filename)
ws1 = wb1.active

# Abrindo o arquivo Excel de destino
filename1 = "testes/positivacao/planilha02.xlsx"
wb2 = xl.load_workbook(filename1)
ws2 = wb2.active

# Obtendo o número total de linhas e colunas na planilha de origem
mr = ws1.max_row
mc = ws1.max_column

# Copiando os valores das células do arquivo de origem para o de destino
for i in range(1, mr + 1):
    for j in range(1, mc + 1):
        # Lendo o valor da célula do arquivo de origem
        c = ws1.cell(row=i, column=j)

        # Escrevendo o valor lido no arquivo de destino
        ws2.cell(row=i, column=j).value = c.value

# Salvando o arquivo Excel de destino
wb2.save(filename1)


import openpyxl as xl

# Abrindo o arquivo Excel de origem
filename = "testes/positivacao/planilha01.xlsx"
wb1 = xl.load_workbook(filename)
ws1 = wb1.active

# Abrindo o arquivo Excel de destino
filename1 = "testes/positivacao/planilha02.xlsx"
wb2 = xl.load_workbook(filename1)
ws2 = wb2.active

# Obtendo o número total de linhas e colunas na planilha de origem
mr = ws1.max_row
mc = ws1.max_column

# Criando um conjunto para armazenar apólices já copiadas
apolices_copiadas = set()

# Definindo as colunas do CPF e da Apólice (supondo que CPF está na coluna 1 e Apólice na coluna 2)
cpf_coluna = 1
apolice_coluna = 2

# Copiando os valores das células do arquivo de origem para o de destino
for i in range(1, mr + 1):
    # Obtendo o CPF e a apólice da linha atual
    cpf = ws1.cell(row=i, column=cpf_coluna).value
    apolice = ws1.cell(row=i, column=apolice_coluna).value

    # Verificando se a apólice já foi copiada
    if apolice not in apolices_copiadas:
        # Adicionando a apólice ao conjunto de apólices copiadas
        apolices_copiadas.add(apolice)

        # Copiando todas as colunas da linha atual
        for j in range(1, mc + 1):
            ws2.cell(row=i, column=j).value = ws1.cell(row=i, column=j).value

# Salvando o arquivo Excel de destino
wb2.save(filename1)


